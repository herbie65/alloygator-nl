<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Test</title>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js';
        import { getFirestore, collection, getDocs, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore.js';

        // Firebase configuratie
        const firebaseConfig = {
            apiKey: "AIzaSyBqXqXqXqXqXqXqXqXqXqXqXqXqXqXqXqX",
            authDomain: "alloygator-nl.firebaseapp.com",
            projectId: "alloygator-nl",
            storageBucket: "alloygator-nl.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdefghijklmnop"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        console.log('Firebase initialized in browser');

        // Test getDocs
        async function testGetDocs() {
            try {
                console.log('Testing getDocs...');
                const productsCollection = collection(db, 'products');
                const productsSnapshot = await getDocs(productsCollection);
                
                console.log(`Found ${productsSnapshot.size} products with getDocs`);
                
                productsSnapshot.forEach((doc) => {
                    const product = doc.data();
                    console.log(`Product: ${product.name || 'No name'} (ID: ${doc.id})`);
                    document.getElementById('results').innerHTML += `<p>Product: ${product.name || 'No name'} (ID: ${doc.id})</p>`;
                });
            } catch (error) {
                console.error('Error with getDocs:', error);
                document.getElementById('results').innerHTML += `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }

        // Test real-time listener
        function testRealTime() {
            try {
                console.log('Testing real-time listener...');
                const productsCollection = collection(db, 'products');
                
                const unsubscribe = onSnapshot(
                    productsCollection,
                    (snapshot) => {
                        console.log(`Real-time update: ${snapshot.size} products`);
                        document.getElementById('realtime').innerHTML = `<p>Real-time: ${snapshot.size} products</p>`;
                        
                        snapshot.forEach((doc) => {
                            const product = doc.data();
                            console.log(`Real-time Product: ${product.name || 'No name'} (ID: ${doc.id})`);
                        });
                    },
                    (error) => {
                        console.error('Real-time listener error:', error);
                        document.getElementById('realtime').innerHTML = `<p style="color: red;">Real-time Error: ${error.message}</p>`;
                    }
                );

                // Stop listening after 10 seconds
                setTimeout(() => {
                    console.log('Stopping real-time listener');
                    unsubscribe();
                }, 10000);
            } catch (error) {
                console.error('Error with real-time listener:', error);
                document.getElementById('realtime').innerHTML = `<p style="color: red;">Real-time Error: ${error.message}</p>`;
            }
        }

        // Run tests
        testGetDocs();
        testRealTime();
    </script>
</head>
<body>
    <h1>Firebase Test</h1>
    <div id="results">
        <h2>GetDocs Results:</h2>
    </div>
    <div id="realtime">
        <h2>Real-time Results:</h2>
    </div>
</body>
</html>
